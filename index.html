<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ—…éŠ / å°¾ç‰™ å ±åç³»çµ±</title>
<style>
  body { font-family: "Microsoft JhengHei", sans-serif; margin:15px; background:#f0f2f5; }
  .container { max-width:500px; margin:auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1);}
  h2 { text-align:center; color: #1a73e8; margin-bottom: 20px; }
  label { display:block; margin-top:12px; font-weight: bold; color: #444; }
  select, input, textarea { width:100%; padding:10px; margin-top:5px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 14px; }
  .btn-group { display: flex; justify-content: space-between; margin-top: 20px; }
  button { padding:12px; width:48%; border:none; border-radius:6px; background:#4CAF50; color:#fff; cursor: pointer; font-weight: bold; transition: 0.3s; }
  button:hover { opacity: 0.8; }
  button.cancel { background:#e53935; }
  #eventInfo, #stats { margin-top:15px; padding:15px; border-radius:8px; display:none; }
  #eventInfo { background:#e8f0fe; border-left: 5px solid #1a73e8; }
  #stats { background:#f8f9fa; border-left: 5px solid #4CAF50; }
  #result { margin-top:15px; text-align: center; font-weight:bold; min-height: 24px; }
  .stat-item { margin-bottom: 10px; border-bottom: 1px dashed #ccc; padding-bottom: 8px; font-size: 14px; line-height: 1.6; }
  #mapBtn { width: 100%; background: #4285F4 !important; margin-top:12px; display: block !important; color: white; }
</style>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
<div class="container">
  <h2>æ—…éŠ / å°¾ç‰™ å ±åç³»çµ±</h2>
  
  <label>é¸æ“‡æ´»å‹•ï¼š
    <select id="eventSelect"><option value="">è¼‰å…¥æ´»å‹•æ¸…å–®ä¸­...</option></select>
  </label>

  <div id="eventInfo">
    <h3 id="evTitle" style="margin:0 0 8px 0; color:#1a73e8;"></h3>
    <p style="margin:4px 0;">ğŸ‘¤ ä¸»è¾¦äººï¼š<span id="evHost"></span></p>
    <p style="margin:4px 0;">ğŸ“… æ™‚é–“ï¼š<span id="evTime"></span></p>
    <p style="margin:4px 0;">ğŸ“ åœ°é»ï¼š<span id="evStore"></span></p>
    <p style="margin:4px 0;">ğŸ  åœ°å€ï¼š<span id="evAddress"></span></p>
    <button type="button" id="mapBtn">ğŸ“ é–‹å•Ÿ Google åœ°åœ–</button>
  </div>

  <form id="regForm" style="display:none;">
    <input type="hidden" id="userId">
    <label>å ±åè€…å§“åï¼š<input type="text" id="userName" readonly></label>
    <label>åƒåŠ äººæ•¸ï¼š<select id="people"></select></label>
    
    <div id="weiyaFields" style="display:none;">
      <label>èªæ¡Œæ•¸é‡ï¼š<select id="table"></select></label>
    </div>
    
    <div id="travelFields" style="display:none;">
      <label>ä¸Šè»Šåœ°é»ï¼š<select id="pickup"></select></label>
      <label>æˆ¿å‹é¸æ“‡ï¼š<select id="room"></select></label>
    </div>
    
    <label>è´ŠåŠ©é …ç›®ï¼š<select id="sponsor"></select></label>
    <div id="spOtherGrp" style="display:none;">
      <label>è´ŠåŠ©é …ç›®åç¨±ï¼š<input type="text" id="spOther" placeholder="è«‹è¼¸å…¥é …ç›®åç¨±"></label>
    </div>
    
    <div id="qtyGrp" style="display:none;">
      <label id="qtyLbl">è´ŠåŠ©æ•¸é‡ï¼š<select id="qty"></select></label>
    </div>

    <label>å‚™è¨»ï¼š<textarea id="memo" rows="2" placeholder="ç‰¹æ®Šé£Ÿæ€§æˆ–å‚™è¨»"></textarea></label>

    <div class="btn-group">
      <button type="submit" id="subBtn">é€å‡ºæ›´æ–°</button>
      <button type="button" class="cancel" id="canBtn">å–æ¶ˆå ±å</button>
    </div>
  </form>

  <div id="result"></div>

  <div id="stats">
    <h3 style="margin:0 0 10px 0; font-size:16px; color:#2e7d32;">ğŸ“Š å³æ™‚å ±åçµ±è¨ˆå›å ±</h3>
    <div id="uStats" class="stat-item"></div>
    <div id="dStats" class="stat-item"></div>
    <div id="sStats" class="stat-item"></div>
  </div>
</div>

<script>
const GAS_URL = 'https://script
